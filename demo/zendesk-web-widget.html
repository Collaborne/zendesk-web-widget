<!doctype html>
<html>
	<head>
		<title>Demo</title>
		<script src="../../webcomponentsjs/webcomponents-lite.js"></script>
		<link rel="import" href="../../iron-flex-layout/iron-flex-layout-classes.html">
		<link rel="import" href="../../paper-button/paper-button.html">
		<link rel="import" href="../../paper-input/paper-input.html">
		<link rel="import" href="../../paper-toggle-button/paper-toggle-button.html">

		<link rel="import" href="../zendesk-web-widget.html">

		<style is="custom-style" include="iron-flex"></style>
	</head>

	<body>
		<template is="dom-bind">
			<div class="layout vertical">
				<paper-input pattern="^\S+$" label="Zendesk Host" on-change="_onHostChange" invalid="{{_hostInvalid}}" value="{{_host}}"></paper-input>
				<div>
					Hidden by default: <paper-toggle-button checked="{{defaultHidden}}"></paper-toggle-button>
				</div>
				<paper-input label="Locale" on-change="_onLocaleChange" value="{{_locale}}"></paper-input>
				<hr>
				<paper-input label="User Name" value="{{user}}"></paper-input>
				<paper-input label="User Email" value="{{email}}"></paper-input>
				<paper-input label="User Organization" value="{{organization}}"></paper-input>
				<hr>
				<paper-input label="Search Topics" value="{{search}}"></paper-input>
				<paper-input label="Search Labels" value="{{labels}}"></paper-input>
			</div>

			<div class="layout horizontal">
				<paper-button on-tap="_hide">Hide</paper-button>
				<paper-button on-tap="_show">Show</paper-button>
				<paper-button on-tap="_activate">Activate</paper-button>
				<paper-button on-tap="_toggle">Toggle</paper-button>
			</div>

			<zendesk-web-widget id="z" host="[[host]]" locale="[[locale]]" default-hidden="[[defaultHidden]]" user="[[user]]" email="[[email]]" organization="[[organization]]" search="[[search]]" labels="[[_split(labels)]]">
		</template>

		<script>
			const scope = document.querySelector('template[is=dom-bind]');
            // Debounce changes in the host/locale, otherwise we get one per key stroke here.
            scope._onHostChange = function() {
                scope.host = scope._host;
            };
            scope._onLocaleChange = function() {
                scope.locale = scope._locale;
            };
            scope._split = function(text) {
                return text.split(/\s+/);
            };

            scope.addEventListener('dom-change', function(e) {
                const z = document.querySelector("#z");
                scope._hide = function() {
                    z.hide();
                };
                scope._show = function() {
                    z.show();
                };
                scope._activate = function() {
                    z.activate();
                };
                scope._toggle = function() {
                    z.toggle();
                };
            });
		</script>
	</body>
</html>
